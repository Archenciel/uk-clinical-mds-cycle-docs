## ADPKD Patient Treatment Process

import {Grid, Item, Divider} from '@mui/material'; // Grid version 1

<div style={{textAlign:"justify"}}>
  This documentation presents a comprehensive overview of the treatment process for patients diagnosed with Autosomal Dominant Polycystic Kidney Disease (ADPKD). 
  ADPKD is a genetic disorder characterized by the growth of cysts in the kidneys, often leading to various complications and affecting overall kidney function. 
  The purpose of this guide is to establish a common baseline for analyzing ADPKD as part of our research on data-driven innovation in the clinical domain. 
  It may also serve as a structured pathway for healthcare professionals to manage and treat individuals living with this condition.

  The process outlined herein is designed to provide a clear, step-by-step approach, from the initial clinic visit to the advanced stages of care. 
  Our approach is grounded in current medical practices and research, incorporating diagnostic procedures, treatment planning, and ongoing management strategies. 
  It reflects a multidisciplinary method, involving various specialties such as nephrology, genetics, and dietetics, to address the multifaceted nature of ADPKD.  

  While creating our concepts, we have consulted with experts in the field from the University clinc of Cologne and have considered the latest developments in ADPKD treatment and research. 
</div>

## Patient Journey
<Grid container spacing={4} margin="0em 0em">
  <Grid xs={12} sm={5} margin="1em 1em">
    #### Initial Clinic Visit
    1) Patient Arrival and Registration
        - Comprehensive medical history documentation.
        - Identification of ADPKD-related symptoms.
        - **Importance**: Early detection and risk assessment (Chapman et al., 2015).
    2) Initial Assessment by Healthcare Professional
        - Detailed physical examination and blood pressure measurement.
        - Evaluation of family history for genetic predisposition.
        - **Consideration**: Early clinical assessment crucial (Chapman et al., 2015).

    #### Diagnostic Process
    3) Laboratory Tests
        - Renal and liver function tests; urine analysis.
        - Options: Advanced genetic testing based on initial results.
        - **Research**: Kidney function markers in ADPKD progression (Müller, R. U., & Benzing, T., 2018).
    4) Imaging Studies
        - Standard renal ultrasound; MRI or CT for detailed imaging.
        - MRI preferred in cases with impaired renal function.
        - **Study**: Imaging modalities in ADPKD (Pei et al., 2015).
    5) Genetic Counseling and Testing (if indicated)
        - Offered to assess risk in family members.
        - Genetic testing confirms diagnosis and aids in family planning.
        - **Impact**: Genetic counseling in patient management (Audrézet et al., 2016).

    #### Treatment Decision
    6) Consultation with Nephrologist
        - Discussion of diagnostic results and kidney function evaluation.
    7) Treatment Planning
        - Personalized treatment based on kidney disease stage and patient health.
        - **Approach**: Personalized treatment plans crucial (Chebib & Torres, 2016).
  </Grid>
  <Grid xs={12} sm={5} margin="1em 1em">
    #### Treatment Implementation
    8) Management of Hypertension
        - Antihypertensive medication and lifestyle changes.
        - First-line treatments: ACE inhibitors or ARBs.
        - **Role**: Blood pressure control in ADPKD progression (Schrier et al., 2014).
    9) Symptom Management
        - Strategies for pain management and infection treatment.
        - Options: Analgesics or surgical interventions for severe pain.
        - Focus: Effective symptom management strategies (Casteleijn et al., 2014).
    10) Lifestyle Modifications
        - Dietary changes, reduced salt intake, and increased water consumption.
        - More details on ADPKD supporting factors: [ADPKD Supporting Factors](http://localhost:3000/nephrology/adpkd-factors)
    11) Medications Specific to ADPKD
        - Use of Tolvaptan under specific criteria.
        - Monitoring for side effects, especially liver function.
        - **Consideration**: Tolvaptan's role in ADPKD (Torres et al., 2017 & Müller et al., 2023).
    12) Regular Monitoring
        - Ongoing kidney function tests and imaging studies.
        - **Innovation**: AI-supported progression monitoring based on kidney volume (Jung et al. 2023).

    #### Advanced Care (if required)
    13) Management of Kidney Failure
        - Dialysis options and kidney transplant evaluation.
    14) Ongoing Support and Counseling
        - Psychological support and education about disease progression.
    15) Follow-up Visits
        - Regular nephrologist check-ups for treatment monitoring and adjustments.
  </Grid>
</Grid>


## Interactive Process Visualization
<div style={{textAlign:"justify"}}>
**Important**: This documentation is still incomplete and may contain incorrect information.
#### ADPKD Patient Journey 
This flow visualizes a generalized patient journey during treatment of ADPKD. It serves as a guideline in the proceedings of this work and is based
on the experiences of the Nephrology Center at the University clinc of Cologne (https://nephrologie.uk-koeln.de/ - TBD).  
</div>

<br/>

import React from 'react';
import ReactFlow, { Background } from 'reactflow';
import 'reactflow/dist/style.css';
import ReactDOM from 'react-dom';
import { Handle, Position, MiniMap, MarkerType } from 'reactflow';

export const SemiCircularEdge = ({
  id,
  sourceX,
  sourceY,
  label,
  style = {},
  markerEndId,
}) => {
  // Define the radius of the small circle and label styles
  const circleRadius = 18;
  const fontSize = 12;
  const padding = 2; // Padding around text inside the rectangle

  // Adjust these for label positioning
  const labelX = sourceX - 60;
  const labelWidth = 80; // Maximum width of the label

  // SVG path for a small circle
  const path = `M ${sourceX} ${sourceY}
                m -${circleRadius}, 0
                a ${circleRadius},${circleRadius} 0 1,0 ${circleRadius * 2},0
                a ${circleRadius},${circleRadius} 0 1,0 -${circleRadius * 2},0`;

  return (
    <g>
      <path
        id={id}
        style={style}
        className="react-flow__edge-path"
        d={path}
        markerEnd={markerEndId}
      />
      <foreignObject
        x={labelX - labelWidth / 2}
        y={sourceY - fontSize - padding * 2}
        width={labelWidth}
        height="100" // Initial height, will expand as needed
      >
        <div
          xmlns="http://www.w3.org/1999/xhtml"
          style={{
            background: 'white',
            color: 'black',
            textAlign: 'center',
            fontSize: `${fontSize}px`,
            padding: `${padding}px`,
            borderRadius: '5px',
            maxWidth: `${labelWidth}px`,
            overflowWrap: 'break-word', // Wrap long words
            wordWrap: 'break-word', // Older browsers
          }}
        >
          {label}
        </div>
      </foreignObject>
    </g>
  );
};


export const CustomNodeComponent = ({ data }) => {
    // Custom Nodes to enable more interactice Flowcharts
  const [showDetails, setShowDetails] = React.useState(false);
  const [detailBoxPosition, setDetailBoxPosition] = React.useState({});
  const nodeRef = React.useRef(null);

  const onMouseEnter = () => {
    if (nodeRef.current) {
      const rect = nodeRef.current.getBoundingClientRect();
      setDetailBoxPosition({ top: rect.bottom + window.scrollY, left: rect.left + window.scrollX });
    }
    setShowDetails(true);
  };

  return  (
    <>
    <Handle type="target" position={Position.Top} id="a" />
        <div
        ref={nodeRef}
        onMouseEnter={onMouseEnter}
        onMouseLeave={() => setShowDetails(false)}
        style={{ 
            padding: '10px', 
            minWidth: '180px',
            maxWidth: '180px',
            color: '#333', 
            textAlign: 'center',
            position: 'relative',
            fontSize: '10pt'
        }}
        >
        {data.label}
        {showDetails && ReactDOM.createPortal(
            <div style={{ 
            position: 'absolute', 
            textAlign: 'left', 
            top: `${detailBoxPosition.top}px`, 
            left: `${detailBoxPosition.left}px`, 
            background: 'black', 
            border: '1px solid black', 
            maxWidth: "500px",
            padding: '5px 10px', 
            borderRadius: '5px', 
            zIndex: 5000, 
            color: "#ffff" 
            }}
            dangerouslySetInnerHTML={{ __html: data.details }}
            />,
            document.body
        )}
        </div>
        <Handle type="source" position={Position.Bottom} id="b" />
        {/* Left handles */}
        <Handle
            type="source"
            position="left"
            id="left1"
            style={{ top: '50%', visibility:"hidden" }}  
        />
    </>
  );
};

export const Flow = () => {
const initialNodes = [
  // Clinic Visit
  {
    id: '1',
    position: { x: 50, y: 50 },
    type: 'customNode',
    data: { 
      label: 'Patient Arrival and Registration',
      details: '<div> <b>Details:</b><br/> Patient provides personal and medical history, symptoms related to ADPKD. </div>'
    },
    style: { background: '#FFD580' }
  },
  {
    id: '2',
    position: { x: 50, y: 150 },
    type: 'customNode',
    data: {
      label: 'Initial Assessment by Healthcare Professional',
      details: '<b>Details:</b><br/> Physical examination and review of family history for ADPKD.'
    },
    style: { background: '#FFD580' }
  },
  {
    id: '3',
    position: { x: 50, y: 250 },
    type: 'customNode',
    data: {
      label: 'Laboratory Tests',
      details: '<b>Details:</b><br/> Blood tests for renal and liver function, urine analysis.'
    },
    style: { background: '#FFD580' }
  },
  {
    id: '4',
    position: { x: 50, y: 350 },
    type: 'customNode',
    data: {
      label: 'Imaging Studies',
      details: '<b>Details:</b><br/> Ultrasound, MRI, or CT scans to assess kidneys and cysts.'
    },
    style: { background: '#FFD580' }
  },
  {
    id: '5',
    position: { x: 50, y: 450 },
    type: 'customNode',
    data: {
      label: 'Genetic Counseling and Testing (if indicated)',
      details: '<b>Details:</b><br/> Assessing risk of ADPKD in family members, genetic testing if necessary.'
    },
    style: { border: '3px dashed #ff8c00', background: '#FFD599' }
  },

  // Treatment Decision
  {
    id: '6',
    position: { x: 50, y: 550 },
    type: 'customNode',
    data: {
      label: 'Consultation with Nephrologist on Results',
      details: '<b>Details:</b><br/> Discussion of test results, kidney function assessment, treatment options.'
    },
    style: { background: '#FFC0CB' }
  },
  {
    id: '7',
    position: { x: 350, y: 50 },
    type: 'customNode',
    data: {
      label: 'Treatment Planning',
      details: '<b>Details:</b></br> Developing a personalized treatment plan based on stage of kidney disease and overall health.'
    },
    style: { background: '#FFC0CB' }
  },

  // At Home
  {
    id: '8',
    position: { x: 350, y: 150 },
    type: 'customNode',
    data: {
      label: 'Management of Hypertension',
      details: '<b>Details:</b></br> Regular blood pressure monitoring, medications to control hypertension.'
    },
    style: { background: '#B7E9F7' }
  },
  {
    id: '9',
    position: { x: 350, y: 250 },
    type: 'customNode',
    data: {
      label: 'Symptom Management',
      details: '<b>Details:</b></br> Pain management, treatment of urinary tract infections, managing blood in urine.'
    },
    style: { background: '#B7E9F7' }
  },
  {
    id: '10',
    position: { x: 350, y: 350 },
    type: 'customNode',
    data: {
      label: 'Lifestyle Modifications',
      details: '<b>Details:</b></br> Dietary changes, increased water intake, and other lifestyle adjustments.'
    },
    style: { background: '#B7E9F7' }
  },
  {
    id: '11',
    position: { x: 350, y: 450 },
    type: 'customNode',
    data: {
      label: 'Medications Specific to ADPKD',
      details: '<b>Details:</b></br> Prescription of drugs like Tolvaptan, monitoring for side effects.'
    },
    style: { background: '#B7E9F7' }
  },
  {
    id: '12',
    position: { x: 350, y: 550 },
    type: 'customNode',
    data: {
      label: 'Regular Monitoring',
      details: '<b>Details:</b></br> Ongoing kidney function tests, periodic imaging studies.'
    },
    style: { background: '#B7E9F7' }
  },

  // Advanced Care
  {
    id: '13',
    position: { x: 650, y: 250 },
    type: 'customNode',
    data: {
      label: 'Management of Kidney Failure (if needed)',
      details: '<b>Details:</b></br> Dialysis, kidney transplant evaluation and planning.'
    },
    style: { border: '3px dashed #FF50CB', background: '#FFC0CB' }
  },
  {
    id: '14',
    position: { x: 650, y: 350 },
    type: 'customNode',
    data: {
      label: 'Ongoing Support and Counseling (if needed)',
      details: '<b>Details:</b></br> Psychological support, education about disease progression and management.'
    },
    style: { border: '3px dashed #FF50CB', background: '#FFC0CB' }
  },
  {
    id: '15',
    position: { x: 650, y: 450 },
    type: 'customNode',
    data: {
      label: 'Follow-up Visits (if needed)',
      details: '<b>Details:</b></br> Regular check-ups with the nephrologist, treatment adjustments as needed.'
    },
    style: { border: '3px dashed #FF50CB', background: '#FFC0CB' }
  },
];

const initialEdges = [
    { id: 'e1-2', source: '1', target: '2', label: 'Same day', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#90ee90' } },
    { id: 'e2-3', source: '2', target: '3', label: '1-2 weeks', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#add8e6' } },
    { id: 'e3-4', source: '3', target: '4', label: '1-2 weeks', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#add8e6' } },
    { id: 'e4-5', source: '4', target: '5', label: '2-4 weeks', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#add8e6' } },
    { id: 'e5-6', source: '5', target: '6', label: '2-4 weeks', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#add8e6' } },
    { id: 'e6-7', source: '6', target: '7', label: '1-2 weeks', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#add8e6' } },
    { id: 'e7-8', source: '7', target: '8', label: 'Immediate', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#90ee90' } },
    { id: 'e8-9', source: '8', target: '9', label: 'As needed', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffb6c1' } },
    { id: 'e9-10', source: '9', target: '10', label: 'Continuous', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffb6c1' } },
    { id: 'e10-11', source: '10', target: '11', label: 'Continuous', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffb6c1' } },
    { id: 'e11-12', source: '11', target: '12', label: 'Continuous', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffb6c1' } },
    { id: 'e12-13', source: '12', target: '13', label: 'As condition progresses', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffa07a' } },
    { id: 'e13-14', source: '13', target: '14', label: 'Continuous', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#ffb6c1' } },
    { id: 'e14-15', source: '14', target: '15', label: 'Regular', markerEnd: { type:MarkerType.ArrowClosed, color:"white"}, style: { stroke: '#90ee90' } },

        // Cyclic edges for ongoing steps
    { id: 'cyclic-8', source: '8', target: '8', type: 'custom', sourceHandle: 'left1', targetHandle: 'left2', type: 'semiCircular', label: 'Ongoing Management', arrowHeadType: 'arrowclosed', style: { strokeDasharray: '5,5', stroke: '#ade8e6' }, animated: true },
    { id: 'cyclic-9', source: '10', target: '10', type: 'custom', sourceHandle: 'left1', targetHandle: 'left2', type: 'semiCircular', label: 'Ongoing', arrowHeadType: 'arrowclosed', style: { strokeDasharray: '5,5', stroke: '#ade8e6' }, animated: true },
    { id: 'cyclic-12', source: '12', target: '12', type: 'custom', sourceHandle: 'left1', targetHandle: 'left2', type: 'semiCircular', label: 'Regular Monitoring', arrowHeadType: 'arrowclosed', style: { strokeDasharray: '5,5', stroke: '#ade8e6' }, animated: true },
    { id: 'cyclic-12', source: '14', target: '14', type: 'custom', sourceHandle: 'left1', targetHandle: 'left2', type: 'semiCircular', label: 'Quarterly', arrowHeadType: 'arrowclosed', style: { strokeDasharray: '5,5', stroke: '#ffa6c1' }, animated: true },
  ];

  return (
    <div style={{ width: '100%', height: '50vh' }}>
      <ReactFlow 
        nodes={initialNodes} 
        edges={initialEdges} 
        nodeTypes={{ customNode: CustomNodeComponent }}
        edgeTypes={{ semiCircular: SemiCircularEdge }}
      >

        <Background color="#aaa" gap={80} />
      </ReactFlow>
    </div>
  );
};


<Flow />

<Divider color="white" style={{margin:"2em 0em 0em 0em"}}/>
### References
<small>
- Müller, R. U., & Benzing, T. (2018). "Management of autosomal-dominant polycystic kidney disease—state-of-the-art."
- Müller, R. U., et al. (2021). "An update on the use of tolvaptan for autosomal dominant polycystic kidney disease: consensus statement on behalf of the ERAWorking Group on Inherited Kidney Disorders, the European Rare Kidney Disease Reference Network and Polycystic Kidney Disease International."
- Jung, H. S., et. al (2023). "Feasibility of artificial intelligence-based decision supporting system in tolvaptan prescription for autosomal dominant polycystic kidney disease."
- Chapman, A. B., et al. (2015). "Autosomal-dominant polycystic kidney disease (ADPKD): Executive summary from a Kidney Disease: Improving Global Outcomes (KDIGO) Controversies Conference."
- Torres, V. E., et al. (2017). "Tolvaptan in Later-Stage Autosomal Dominant Polycystic Kidney Disease."
- Grantham, J. J., et al. (2009). "Autosomal dominant polycystic kidney disease: The last 3 years."
- Pei, Y., et al. (2015). "Imaging-based diagnosis of autosomal dominant polycystic kidney disease."
- Audrézet, M. P., et al. (2016). "Autosomal Dominant Polycystic Kidney Disease: Comprehensive mutation analysis of PKD1 and PKD2 in 700 unrelated patients."
- Chebib, F. T., & Torres, V. E. (2016). "Autosomal Dominant Polycystic Kidney Disease: Core Curriculum 2016."
- Schrier, R. W., et al. (2014). "Blood pressure in early autosomal dominant polycystic kidney disease."
- Casteleijn, N. F., et al. (2014). "A stepwise approach for effective management of chronic pain in autosomal-dominant polycystic kidney disease."
</small>